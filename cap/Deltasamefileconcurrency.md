# Delta Lake same file concurrency test

- Create a Pipeline

![alt text](https://github.com/balakreshnan/Accenture/blob/master/cap/images/concurrencytest1.jpg "Conn 1")

- Add 2 data flow with same flow

- Input is parquet file. and then do a select and alter row to filter
- Sink with upsert and upsert key with same file.

- Creaet Data Flow Task
- Go to Data Flow

![alt text](https://github.com/balakreshnan/Accenture/blob/master/cap/images/concurrencytest2.jpg "Conn 2")

![alt text](https://github.com/balakreshnan/Accenture/blob/master/cap/images/concurrencytest3.jpg "Conn 3")

![alt text](https://github.com/balakreshnan/Accenture/blob/master/cap/images/concurrencytest4.jpg "Conn 4")

![alt text](https://github.com/balakreshnan/Accenture/blob/master/cap/images/concurrencytest5.jpg "Conn 5")

![alt text](https://github.com/balakreshnan/Accenture/blob/master/cap/images/concurrencytest6.jpg "Conn 6")

- Now Save and Publish